-- LocalMaze UI Library - ENHANCED DESIGN
-- Clean, modern look with toggle buttons and improved visuals

local LocalMaze = {}
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")

function LocalMaze:CreateWindow(Title)
    local screenGui = Instance.new("ScreenGui")
    screenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.Name = "LocalMazeUI"

    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Parent = screenGui
    mainFrame.BackgroundColor3 = Color3.fromRGB(18, 18, 18)
    mainFrame.BackgroundTransparency = 0.1
    mainFrame.Position = UDim2.new(0, 136, 0, 24)
    mainFrame.Size = UDim2.new(0, 444, 0, 284)
    mainFrame.BorderSizePixel = 0
    mainFrame.Active = true
    mainFrame.Draggable = true

    local mainCorner = Instance.new("UICorner", mainFrame)
    mainCorner.CornerRadius = UDim.new(0, 10)

    -- Topbar
    local topbar = Instance.new("Frame")
    topbar.Name = "Topbar"
    topbar.Parent = mainFrame
    topbar.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    topbar.BackgroundTransparency = 0.1
    topbar.Size = UDim2.new(1, 0, 0, 62)
    topbar.BorderSizePixel = 0

    local topbarCorner = Instance.new("UICorner", topbar)
    topbarCorner.CornerRadius = UDim.new(0, 10)

    -- Gradient Bar
    local gradientBar = Instance.new("Frame")
    gradientBar.Parent = topbar
    gradientBar.BackgroundColor3 = Color3.new(1,1,1)
    gradientBar.Position = UDim2.new(0, 0, 0, 50)
    gradientBar.Size = UDim2.new(1, 0, 0, 12)
    gradientBar.BorderSizePixel = 0

    local gradient = Instance.new("UIGradient", gradientBar)
    gradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 220, 255)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(180, 0, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 0, 120))
    }
    gradient.Rotation = 15

    -- Title Area
    local titleFrame = Instance.new("Frame")
    titleFrame.Parent = topbar
    titleFrame.BackgroundTransparency = 1
    titleFrame.Size = UDim2.new(1, 0, 0, 50)

    local windowTitle = Instance.new("TextLabel")
    windowTitle.Parent = titleFrame
    windowTitle.BackgroundTransparency = 1
    windowTitle.Position = UDim2.new(0, 16, 0, 14)
    windowTitle.Size = UDim2.new(0, 308, 0, 22)
    windowTitle.FontFace = Font.new("rbxasset://fonts/families/GothamSSm.json")
    windowTitle.Text = Title or "LocalMaze"
    windowTitle.TextColor3 = Color3.fromRGB(240, 240, 240)
    windowTitle.TextSize = 18
    windowTitle.TextXAlignment = Enum.TextXAlignment.Left

    -- Control Buttons
    local minimizeBtn = Instance.new("TextButton")
    minimizeBtn.Parent = titleFrame
    minimizeBtn.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
    minimizeBtn.Position = UDim2.new(0, 366, 0, 10)
    minimizeBtn.Size = UDim2.new(0, 32, 0, 32)
    minimizeBtn.Text = "_"
    minimizeBtn.TextColor3 = Color3.fromRGB(220, 220, 220)
    minimizeBtn.FontFace = Font.new("rbxasset://fonts/families/GothamSSm.json")
    minimizeBtn.TextSize = 16
    minimizeBtn.BorderSizePixel = 0

    local minCorner = Instance.new("UICorner", minimizeBtn)
    minCorner.CornerRadius = UDim.new(0, 6)

    local closeBtn = Instance.new("TextButton")
    closeBtn.Parent = titleFrame
    closeBtn.BackgroundColor3 = Color3.fromRGB(220, 60, 60)
    closeBtn.Position = UDim2.new(0, 402, 0, 10)
    closeBtn.Size = UDim2.new(0, 32, 0, 32)
    closeBtn.Text = "Ã—"
    closeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    closeBtn.FontFace = Font.new("rbxasset://fonts/families/GothamSSm.json")
    closeBtn.TextSize = 18
    closeBtn.BorderSizePixel = 0

    local closeCorner = Instance.new("UICorner", closeBtn)
    closeCorner.CornerRadius = UDim.new(0, 6)

    -- Tab List
    local tabScroll = Instance.new("ScrollingFrame")
    tabScroll.Name = "TabScroll"
    tabScroll.Parent = mainFrame
    tabScroll.BackgroundColor3 = Color3.fromRGB(22, 22, 22)
    tabScroll.BackgroundTransparency = 0.1
    tabScroll.Position = UDim2.new(0, 8, 0, 68)
    tabScroll.Size = UDim2.new(0, 132, 0, 208)
    tabScroll.BorderSizePixel = 0
    tabScroll.ScrollBarThickness = 3
    tabScroll.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 80)
    tabScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y

    local tabCorner = Instance.new("UICorner", tabScroll)
    tabCorner.CornerRadius = UDim.new(0, 8)

    local tabList = Instance.new("UIListLayout", tabScroll)
    tabList.Padding = UDim.new(0, 6)
    tabList.HorizontalAlignment = Enum.HorizontalAlignment.Center

    -- Content Area
    local contentScroll = Instance.new("ScrollingFrame")
    contentScroll.Name = "ContentScroll"
    contentScroll.Parent = mainFrame
    contentScroll.BackgroundColor3 = Color3.fromRGB(28, 28, 28)
    contentScroll.BackgroundTransparency = 0.1
    contentScroll.Position = UDim2.new(0, 148, 0, 70)
    contentScroll.Size = UDim2.new(0, 284, 0, 206)
    contentScroll.BorderSizePixel = 0
    contentScroll.ScrollBarThickness = 4
    contentScroll.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 80)
    contentScroll.AutomaticCanvasSize = Enum.AutomaticSize.Y

    local contentCorner = Instance.new("UICorner", contentScroll)
    contentCorner.CornerRadius = UDim.new(0, 8)

    -- Button Hover Effects
    local function setupButtonHover(button)
        local originalColor = button.BackgroundColor3
        local hoverColor = Color3.fromRGB(
            math.min(originalColor.R * 255 + 20, 255),
            math.min(originalColor.G * 255 + 20, 255),
            math.min(originalColor.B * 255 + 20, 255)
        )
        
        button.MouseEnter:Connect(function()
            TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = hoverColor}):Play()
        end)
        
        button.MouseLeave:Connect(function()
            TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = originalColor}):Play()
        end)
    end

    -- Window Controls
    local minimized = false
    minimizeBtn.MouseButton1Click:Connect(function()
        minimized = not minimized
        if minimized then
            mainFrame.Size = UDim2.new(0, 444, 0, 62)
            tabScroll.Visible = false
            contentScroll.Visible = false
        else
            mainFrame.Size = UDim2.new(0, 444, 0, 284)
            tabScroll.Visible = true
            contentScroll.Visible = true
        end
    end)

    closeBtn.MouseButton1Click:Connect(function()
        screenGui:Destroy()
    end)

    setupButtonHover(minimizeBtn)
    setupButtonHover(closeBtn)

    local activeContent = nil
    local activeTab = nil

    function LocalMaze:AddTab(name)
        local tabBtn = Instance.new("TextButton")
        tabBtn.Parent = tabScroll
        tabBtn.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
        tabBtn.BackgroundTransparency = 0.1
        tabBtn.Size = UDim2.new(0, 120, 0, 36)
        tabBtn.FontFace = Font.new("rbxasset://fonts/families/GothamSSm.json")
        tabBtn.Text = name
        tabBtn.TextColor3 = Color3.fromRGB(200, 200, 200)
        tabBtn.TextSize = 16
        tabBtn.AutoButtonColor = false
        tabBtn.BorderSizePixel = 0

        local btnCorner = Instance.new("UICorner", tabBtn)
        btnCorner.CornerRadius = UDim.new(0, 6)

        local tabContent = Instance.new("Frame")
        tabContent.Parent = contentScroll
        tabContent.BackgroundTransparency = 1
        tabContent.Size = UDim2.new(1, -12, 0, 0)
        tabContent.Visible = false

        local list = Instance.new("UIListLayout", tabContent)
        list.Padding = UDim.new(0, 8)
        list.HorizontalAlignment = Enum.HorizontalAlignment.Center

        local function activateTab()
            if activeTab then
                activeTab.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
            end
            if activeContent then 
                activeContent.Visible = false 
            end
            
            tabBtn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
            tabContent.Visible = true
            activeContent = tabContent
            activeTab = tabBtn
            contentScroll.CanvasPosition = Vector2.new(0, 0)
        end

        tabBtn.MouseButton1Click:Connect(activateTab)
        setupButtonHover(tabBtn)

        if not activeContent then
            activateTab()
        end

        local tab = {}

        function tab:AddButton(title, callback)
            local frame = Instance.new("Frame")
            frame.Size = UDim2.new(0, 260, 0, 42)
            frame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
            frame.BackgroundTransparency = 0.1
            frame.BorderSizePixel = 0
            frame.Parent = tabContent

            local c = Instance.new("UICorner", frame)
            c.CornerRadius = UDim.new(0, 6)

            local t = Instance.new("TextLabel")
            t.Text = title or "Button"
            t.Position = UDim2.new(0, 12, 0, 10)
            t.Size = UDim2.new(0, 160, 0, 22)
            t.BackgroundTransparency = 1
            t.TextColor3 = Color3.fromRGB(240, 240, 240)
            t.FontFace = Font.new("rbxasset://fonts/families/GothamSSm.json")
            t.TextSize = 16
            t.TextXAlignment = Enum.TextXAlignment.Left
            t.Parent = frame

            local btn = Instance.new("TextButton")
            btn.Text = "Execute"
            btn.Size = UDim2.new(0, 70, 0, 26)
            btn.Position = UDim2.new(0, 180, 0, 8)
            btn.BackgroundColor3 = Color3.fromRGB(0, 180, 80)
            btn.TextColor3 = Color3.fromRGB(255, 255, 255)
            btn.FontFace = Font.new("rbxasset://fonts/families/GothamSSm.json")
            btn.TextSize = 14
            btn.BorderSizePixel = 0
            btn.Parent = frame

            local bc = Instance.new("UICorner", btn)
            bc.CornerRadius = UDim.new(0, 6)

            btn.MouseButton1Click:Connect(callback or function() end)
            setupButtonHover(btn)
        end

        function tab:AddLabel(text)
            local frame = Instance.new("Frame")
            frame.Size = UDim2.new(0, 260, 0, 36)
            frame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
            frame.BackgroundTransparency = 0.1
            frame.BorderSizePixel = 0
            frame.Parent = tabContent

            local c = Instance.new("UICorner", frame)
            c.CornerRadius = UDim.new(0, 6)

            local label = Instance.new("TextLabel")
            label.Text = text or "Label"
            label.Position = UDim2.new(0, 12, 0, 8)
            label.Size = UDim2.new(0, 236, 0, 20)
            label.BackgroundTransparency = 1
            label.TextColor3 = Color3.fromRGB(220, 220, 220)
            label.FontFace = Font.new("rbxasset://fonts/families/GothamSSm.json")
            label.TextSize = 16
            label.TextXAlignment = Enum.TextXAlignment.Left
            label.Parent = frame
        end

        function tab:AddToggle(title, default, callback)
            local frame = Instance.new("Frame")
            frame.Size = UDim2.new(0, 260, 0, 36)
            frame.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
            frame.BackgroundTransparency = 0.1
            frame.BorderSizePixel = 0
            frame.Parent = tabContent

            local c = Instance.new("UICorner", frame)
            c.CornerRadius = UDim.new(0, 6)

            local t = Instance.new("TextLabel")
            t.Text = title or "Toggle"
            t.Position = UDim2.new(0, 12, 0, 8)
            t.Size = UDim2.new(0, 160, 0, 20)
            t.BackgroundTransparency = 1
            t.TextColor3 = Color3.fromRGB(240, 240, 240)
            t.FontFace = Font.new("rbxasset://fonts/families/GothamSSm.json")
            t.TextSize = 16
            t.TextXAlignment = Enum.TextXAlignment.Left
            t.Parent = frame

            local toggleBtn = Instance.new("TextButton")
            toggleBtn.Size = UDim2.new(0, 50, 0, 24)
            toggleBtn.Position = UDim2.new(0, 198, 0, 6)
            toggleBtn.BackgroundColor3 = default and Color3.fromRGB(0, 180, 80) or Color3.fromRGB(80, 80, 80)
            toggleBtn.Text = ""
            toggleBtn.BorderSizePixel = 0
            toggleBtn.Parent = frame

            local bc = Instance.new("UICorner", toggleBtn)
            bc.CornerRadius = UDim.new(0, 4)

            local toggled = default or false

            toggleBtn.MouseButton1Click:Connect(function()
                toggled = not toggled
                if toggled then
                    TweenService:Create(toggleBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(0, 180, 80)}):Play()
                else
                    TweenService:Create(toggleBtn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.fromRGB(80, 80, 80)}):Play()
                end
                if callback then callback(toggled) end
            end)

            setupButtonHover(toggleBtn)
        end

        return tab
    end

    return LocalMaze
end

return LocalMaze
